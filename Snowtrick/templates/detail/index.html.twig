{% extends 'base.html.twig' %}

{% block title %}Hello DetailController!{% endblock %}

{% block body %}

<h1>Detail Trick</h1>

<!-- fonction dump() utilisé grace au bundle vardumper -->
<p>{{ dump(app.user) }}</p>
<!-- Affichage de ma variable comments -->
<!--<p>{{ dump(comments) }}</p>-->



<!-- Affichage de ma liste de Tricks -->
<ul>
    <!-- Si User connecté, creation de commentaire possible avec formulaire -->
    {% if app.user %}
        <h3>Créer votre commentaire</h3>
        {{ form(comment_form) }}
    {% endif %}


    <!-- Detail du trick-->
    {% if trick %}
        <h2>Detail du trick</h2>
        <!-- Passer le titre en lien vers la page details du trick à terme -->
        <li>{{ trick.getTitle|e }}</li>
        <!-- Description Trick -->
        <li>{{ trick.getDescription|e }}</li>
        <!-- Groupe Trick -->
        <li>{{ trick.groupe|e }}</li>
        <!-- Image Trick -->
        <li>{{ trick.image|e }}</li>
        <!-- Video Trick -->
        <li>{{ trick.video|e }}</li>
        <!-- Date Trick -->
        <li>{{ trick.dateCreate|date("m/d/Y") }}</li>
    {% endif %}



    <!-- Recuperation de ma variable comments, affichage de chaque commentaire -->
    <div style="margin-top:3rem;">
        <h1>Espace de discussion</h1>
        {% if comments %}
            {% for comment in comments %}

                <!--<p>{{ dump(comment) }}</p>-->

                <div style="display:flex;">
                    <li>
                        <!-- Si User connecté + user admin en is_verified = true -->
                        {% if app.user and app.user.roles[0] != "ROLE_USER"  %}
                            <a href="/delete/comment/{{comment.id}}"><i class="fa-solid fa-trash-can"></i></a>
                            <input type="hidden" value={{comment.id}}/>
                        {% endif %}
                        
                        <p>Commentaire créer par {{ comment.getUser.username|e }} {{ comment.getUser.firstname|e }}, le {{ comment.getDateCreate|date("m/d/Y") }}</p>
                        <p>{{ comment.getContent|e }}</p>
                    </li>
                </div>
                
            {% endfor %}
        {% endif %}
    </div>
</ul>


{% endblock %}
